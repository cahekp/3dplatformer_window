# 3D Платформер: Окна

![](https://github.com/cahekp/3dplatformer_window/blob/main/demo.gif)

# Инструкция по запуску
1. Скачиваем и устанавливаем Unigine SDK Browser
2. Устанавливаем Unigine SDK Community (2.15)
3. Создаем новый C++ проект со следующими параметрами:
- Project Name: camera_window
- SDK: UNIGINE 2 Community (2.15)
- Engine: Development
- Template: Empty
- API + IDE: C++ (Visual Studio 2015+)
- Precision: Float
4. Копируем содержимое git репозитория в созданный проект с заменой файлов
5. Открываем sln в Visual Studio, собираем и запускаем проект

# Что происходит
Данное демо показывает как можно ограничить движение объекта некоторым прямоугольником, описанным в экранном пространстве.

1. Переводим координаты игрока в экранное пространство (точнее, 8 крайних точек его BoundBox'а)
   Unigine: Player::getScreenPosition(), Unity: Camera.WorldToScreenPoint()
2. Из 8 точек формируем прямоугольник (в котором вписаны все 8 точек) в экранных координатах ("mb_rect")
3. Проверяем, выходит ли полученный прямоугольник "mb_rect" за пределы глобального окна "rect"
4. Если да, то нам надо сместить камеру по плоскости, проходящей через игрока. Для этого нам надо найти два вектора: вектор из камеры в сторону игрока и вектор из камеры в сторону ближайшей границы окна
Unigine: Player::getDirectionFromScreen(), Unity: Camera.ScreenPointToRay()
5. Находим точки пересечения векторов с плоскостью (которую выбираем сами! Переменная: plane_normal) и их разница - это и есть то самое целевое смещение для камеры
Unigine: Math::rayPlaneIntersection(), Unity: Plane.Raycast()
6. Смещаем камеру на полученное значение!
